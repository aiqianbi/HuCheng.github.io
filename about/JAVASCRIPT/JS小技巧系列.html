<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JS 小技巧系列 | hucheng 的文档库</title>
    <meta name="description" content="前端工程师 hucheng 的文档库">
    <link rel="icon" href="./img/labixiaoxin.jpeg">
    
    <link rel="preload" href="/assets/css/styles.a8f93003.css" as="style"><link rel="preload" href="/assets/js/app.a8f93003.js" as="script"><link rel="preload" href="/assets/js/5.b3747f02.js" as="script"><link rel="prefetch" href="/assets/css/1.styles.713a3c52.css"><link rel="prefetch" href="/assets/css/2.styles.a2bd3099.css"><link rel="prefetch" href="/assets/js/1.713a3c52.js"><link rel="prefetch" href="/assets/js/2.a2bd3099.js"><link rel="prefetch" href="/assets/js/3.956e8f1b.js"><link rel="prefetch" href="/assets/js/4.3760f0b6.js"><link rel="prefetch" href="/assets/js/6.14ff8164.js"><link rel="prefetch" href="/assets/js/7.9a62c3c3.js">
    <link rel="stylesheet" href="/assets/css/1.styles.713a3c52.css"><link rel="stylesheet" href="/assets/css/2.styles.a2bd3099.css"><link rel="stylesheet" href="/assets/css/styles.a8f93003.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">hucheng 的文档库</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">博文</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/about/OTHERS/Markdown使用语法.html" class="nav-link">markdown使用语法</a></li><li class="dropdown-item"><!----> <a href="/about/JAVASCRIPT/JS小技巧系列.html" class="nav-link">JS小技巧系列</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link router-link-active">分类</a></div><div class="nav-item"><a href="https://www.github.com/aiqianbi" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">博文</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/about/OTHERS/Markdown使用语法.html" class="nav-link">markdown使用语法</a></li><li class="dropdown-item"><!----> <a href="/about/JAVASCRIPT/JS小技巧系列.html" class="nav-link">JS小技巧系列</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link router-link-active">分类</a></div><div class="nav-item"><a href="https://www.github.com/aiqianbi" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>JAVASCRIPT</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/about/JAVASCRIPT/JS小技巧系列.html" class="active sidebar-link">JS小技巧系列</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/about/JAVASCRIPT/JS小技巧系列.html#_1-类型强制转换" class="sidebar-link">1. 类型强制转换</a></li><li class="sidebar-sub-header"><a href="/about/JAVASCRIPT/JS小技巧系列.html#_2-函数" class="sidebar-link">2. 函数</a></li><li class="sidebar-sub-header"><a href="/about/JAVASCRIPT/JS小技巧系列.html#_3-字符串" class="sidebar-link">3. 字符串</a></li><li class="sidebar-sub-header"><a href="/about/JAVASCRIPT/JS小技巧系列.html#_4-数字" class="sidebar-link">4. 数字</a></li><li class="sidebar-sub-header"><a href="/about/JAVASCRIPT/JS小技巧系列.html#_5-数组" class="sidebar-link">5. 数组</a></li><li class="sidebar-sub-header"><a href="/about/JAVASCRIPT/JS小技巧系列.html#_6-对象" class="sidebar-link">6. 对象</a></li><li class="sidebar-sub-header"><a href="/about/JAVASCRIPT/JS小技巧系列.html#_7-代码复用" class="sidebar-link">7. 代码复用</a></li></ul></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>OTHERS</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="js-小技巧系列"><a href="#js-小技巧系列" aria-hidden="true" class="header-anchor">#</a> JS 小技巧系列</h1> <p>本文主要介绍一些JS中用到的小技巧，可以在日常Coding中提升幸福度，将不定期更新~</p> <h2 id="_1-类型强制转换"><a href="#_1-类型强制转换" aria-hidden="true" class="header-anchor">#</a> 1. 类型强制转换</h2> <h3 id="_1-1-string强制转换为数字"><a href="#_1-1-string强制转换为数字" aria-hidden="true" class="header-anchor">#</a> 1.1 string强制转换为数字</h3> <p>可以用*1来转化为数字(实际上是调用.valueOf方法) 然后使用Number.isNaN来判断是否为NaN，或者使用 a !== a 来判断是否为NaN，因为 NaN !== NaN</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'32'</span> <span class="token operator">*</span> <span class="token number">1</span>            <span class="token comment">// 32</span>
<span class="token string">'ds'</span> <span class="token operator">*</span> <span class="token number">1</span>            <span class="token comment">// NaN</span>
<span class="token keyword">null</span> <span class="token operator">*</span> <span class="token number">1</span>            <span class="token comment">// 0</span>
undefined <span class="token operator">*</span> <span class="token number">1</span>    <span class="token comment">// NaN</span>
<span class="token number">1</span>  <span class="token operator">*</span> <span class="token punctuation">{</span> valueOf<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token string">'3'</span> <span class="token punctuation">}</span>        <span class="token comment">// 3</span>
</code></pre></div><p><strong>常用：</strong> 也可以使用+来转化字符串为数字</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">+</span> <span class="token string">'123'</span>            <span class="token comment">// 123</span>
<span class="token operator">+</span> <span class="token string">'ds'</span>               <span class="token comment">// NaN</span>
<span class="token operator">+</span> <span class="token string">''</span>                    <span class="token comment">// 0</span>
<span class="token operator">+</span> <span class="token keyword">null</span>              <span class="token comment">// 0</span>
<span class="token operator">+</span> undefined    <span class="token comment">// NaN</span>
<span class="token operator">+</span> <span class="token punctuation">{</span> valueOf<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token string">'3'</span> <span class="token punctuation">}</span>    <span class="token comment">// 3</span>
</code></pre></div><h3 id="_1-2-object强制转化为string"><a href="#_1-2-object强制转化为string" aria-hidden="true" class="header-anchor">#</a> 1.2 object强制转化为string</h3> <p>可以使用 字符串+Object 的方式来转化对象为字符串(实际上是调用 .toString() 方法)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'the Math object:'</span> <span class="token operator">+</span> Math                <span class="token comment">// &quot;the Math object:[object Math]&quot;</span>
<span class="token string">'the JSON object:'</span> <span class="token operator">+</span> <span class="token constant">JSON</span>              <span class="token comment">// &quot;the JSON object:[object JSON]&quot;</span>
</code></pre></div><p>当然也可以覆盖对象的toString和valueOf方法来自定义对象的类型转换：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">2</span>  <span class="token operator">*</span> <span class="token punctuation">{</span> valueOf<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token string">'3'</span> <span class="token punctuation">}</span>                <span class="token comment">// 6</span>
<span class="token string">'J'</span> <span class="token operator">+</span> <span class="token punctuation">{</span> toString<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token string">'S'</span> <span class="token punctuation">}</span>                <span class="token comment">// &quot;JS&quot;</span>
</code></pre></div><blockquote><p>《Effective JavaScript》P11：当+用在连接字符串时，当一个对象既有toString方法又有valueOf方法时候，JS通过盲目使用valueOf方法来解决这种含糊。对象通过valueOf方法强制转换为数字，通过toString方法强制转换为字符串</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">''</span> <span class="token operator">+</span> <span class="token punctuation">{</span>toString<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token string">'S'</span><span class="token punctuation">,</span>valueOf<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token string">'J'</span><span class="token punctuation">}</span>                <span class="token comment">// J</span>
</code></pre></div><h3 id="_1-3-使用boolean过滤数组中的所有假值"><a href="#_1-3-使用boolean过滤数组中的所有假值" aria-hidden="true" class="header-anchor">#</a> 1.3 使用Boolean过滤数组中的所有假值</h3> <p>我们知道JS中有一些假值：false，null，0，&quot;&quot;，undefined，NaN，怎样把数组中的假值快速过滤呢，可以使用Boolean构造函数来进行一次转换</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">compact</span> <span class="token operator">=</span> arr <span class="token operator">=&gt;</span> arr<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>Boolean<span class="token punctuation">)</span>
<span class="token function">compact</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'e'</span> <span class="token operator">*</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">NaN</span><span class="token punctuation">,</span> <span class="token string">'s'</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">)</span>             <span class="token comment">// [ 1, 2, 3, 'a', 's', 34 ]</span>
</code></pre></div><h3 id="_1-4-双位运算符"><a href="#_1-4-双位运算符" aria-hidden="true" class="header-anchor">#</a> 1.4 双位运算符 ~~</h3> <p>可以使用双位操作符来替代 Math.floor( )。双否定位操作符的优势在于它执行相同的操作运行速度更快。</p> <div class="language-js extra-class"><pre class="language-js"><code>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token number">4.9</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">4</span>      <span class="token comment">//true</span>
<span class="token comment">// 简写为：</span>
<span class="token operator">~</span><span class="token operator">~</span><span class="token number">4.9</span> <span class="token operator">===</span> <span class="token number">4</span>      <span class="token comment">//true</span>
</code></pre></div><p>不过要注意，对整数来说 ~~ 运算结果与 Math.floor( ) 运算结果相同，而对于负数来说不相同：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">~</span><span class="token operator">~</span><span class="token number">4.5</span>            <span class="token comment">// 4</span>
Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token number">4.5</span><span class="token punctuation">)</span>        <span class="token comment">// 4</span>
<span class="token operator">~</span><span class="token operator">~</span><span class="token operator">-</span><span class="token number">4.5</span>        <span class="token comment">// -4</span>
Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">4.5</span><span class="token punctuation">)</span>        <span class="token comment">// -5</span>
</code></pre></div><h3 id="_1-5-短路运算符"><a href="#_1-5-短路运算符" aria-hidden="true" class="header-anchor">#</a> 1.5 短路运算符</h3> <p>我们知道逻辑与 &amp;&amp; 与逻辑或 || 是短路运算符，短路运算符就是从左到右的运算中前者满足要求，就不再执行后者了； 可以理解为：</p> <ul><li>&amp;&amp;为取假运算，从左到右依次判断，如果遇到一个假值，就返回假值，以后不再执行，否则返回最后一个真值</li> <li>|| 为取真运算，从左到右依次判断，如果遇到一个真值，就返回真值，以后不再执行，否则返回最后一个假值</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> param1 <span class="token operator">=</span> expr1 <span class="token operator">&amp;&amp;</span> expr2
<span class="token keyword">let</span> param2 <span class="token operator">=</span> expr1 <span class="token operator">||</span> expr2
</code></pre></div><table><thead><tr><th>运算符</th> <th>示例</th> <th>说明</th></tr></thead> <tbody><tr><td>&amp;&amp;</td> <td>expr1&amp;&amp;expr2</td> <td>如果expr1 能转换成false则返回expr1,否则返回expr2. 因此, 在Boolean环境中使用时, 两个操作结果都为true时返回true,否则返回false.</td></tr> <tr><td>||</td> <td>expr1||expr2</td> <td>如果expr1能转换成true则返回expr1,否则返回expr2. 因此,在boolean环境(在if的条件判断中)中使用时, 二者操作结果中只要有一个为true,返回true;二者操作结果都为false时返回false.</td></tr> <tr><td>!</td> <td>!expr</td> <td>如果单个表达式能转换为true的话返回false,否则返回true.</td></tr></tbody></table> <p>因此可以用来做很多有意思的事，比如给变量赋初值：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> variable1
<span class="token keyword">let</span> variable2 <span class="token operator">=</span> variable1  <span class="token operator">||</span> <span class="token string">'foo'</span>
</code></pre></div><p>如果variable1是真值就直接返回了，后面短路就不会被返回了，如果为假值，则会返回后面的foo。</p> <p>也可以用来进行简单的判断，取代冗长的if语句：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> variable <span class="token operator">=</span> param <span class="token operator">&amp;&amp;</span> param<span class="token punctuation">.</span>prop
</code></pre></div><p>如果param如果为真值则返回param.prop属性，否则返回param这个假值，这样在某些地方防止param为undefined的时候还取其属性造成报错。</p> <h3 id="_1-6-取整-0"><a href="#_1-6-取整-0" aria-hidden="true" class="header-anchor">#</a> 1.6 取整 | 0</h3> <p>对一个数字 | 0可以取整，负数也同样适用，num | 0</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">1.3</span> <span class="token operator">|</span> <span class="token number">0</span>         <span class="token comment">// 1</span>
<span class="token operator">-</span><span class="token number">1.9</span> <span class="token operator">|</span> <span class="token number">0</span>        <span class="token comment">// -1</span>
</code></pre></div><h3 id="_1-7-判断奇偶数-1"><a href="#_1-7-判断奇偶数-1" aria-hidden="true" class="header-anchor">#</a> 1.7 判断奇偶数 &amp; 1</h3> <p>对一个数字 &amp; 1可以判断奇偶数，负数也同样适用，num &amp; 1</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> num<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>
<span class="token operator">!</span><span class="token operator">!</span><span class="token punctuation">(</span>num <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span>                    <span class="token comment">// true</span>
<span class="token operator">!</span><span class="token operator">!</span><span class="token punctuation">(</span>num <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span>                    <span class="token comment">// true</span>
</code></pre></div><h2 id="_2-函数"><a href="#_2-函数" aria-hidden="true" class="header-anchor">#</a> 2. 函数</h2> <h3 id="_2-1-函数默认值"><a href="#_2-1-函数默认值" aria-hidden="true" class="header-anchor">#</a> 2.1 函数默认值</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function-variable function">func</span> <span class="token operator">=</span> <span class="token punctuation">(</span>l<span class="token punctuation">,</span> m <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token number">4</span> <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>l <span class="token operator">*</span> m <span class="token operator">*</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">func</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>             <span class="token comment">//output: 24</span>
</code></pre></div><p>注意，传入参数为undefined或者不传入的时候会使用默认参数，但是传入null还是会覆盖默认参数</p> <h3 id="_2-2-强制参数"><a href="#_2-2-强制参数" aria-hidden="true" class="header-anchor">#</a> 2.2 强制参数</h3> <p>默认情况下，如果不向函数参数传值，那么JS 会将函数参数设置为undefined。其它一些语言则会发出警告或错误。要执行参数分配，可以使用if语句抛出未定义的错误，或者可以利用强制参数。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function-variable function">mandatory</span> <span class="token operator">=</span> <span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Missing parameter!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
foo <span class="token operator">=</span> <span class="token punctuation">(</span>bar <span class="token operator">=</span> <span class="token function">mandatory</span><span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>     <span class="token comment">// 这里如果不传入参数，就会执行manadatory函数报出错误</span>
  <span class="token keyword">return</span> bar<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-3-隐式返回值"><a href="#_2-3-隐式返回值" aria-hidden="true" class="header-anchor">#</a> 2.3 隐式返回值</h3> <p>返回值是我们通常用来返回函数最终结果的关键字。只有一个语句的箭头函数，可以隐式返回结果（函数必须省略大括号{ }，以便省略返回关键字）。<br> <br>要返回多行语句（例如对象文本），需要使用( )而不是{ }来包裹函数体。这样可以确保代码以单个语句的形式进行求值。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">calcCircumference</span><span class="token punctuation">(</span>diameter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> diameter
<span class="token punctuation">}</span>
<span class="token comment">// 简写为：</span>
<span class="token function-variable function">calcCircumference</span> <span class="token operator">=</span> diameter <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> diameter<span class="token punctuation">;</span>
<span class="token punctuation">)</span>
</code></pre></div><h3 id="_2-4-惰性载入函数"><a href="#_2-4-惰性载入函数" aria-hidden="true" class="header-anchor">#</a> 2.4 惰性载入函数</h3> <p>在某个场景下我们的函数中有判断语句，这个判断依据在整个项目运行期间一般不会变化，所以判断分支在整个项目运行期间只会运行某个特定分支，那么就可以考虑惰性载入函数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">!==</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'aaa'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'bbb'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
 
<span class="token comment">// 优化后</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">!=</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'aaa'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'bbb'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>那么第一次运行之后就会覆写这个方法，下一次再运行的时候就不会执行判断了。当然现在只有一个判断，如果判断很多，分支比较复杂，那么节约的资源还是可观的。</p> <h3 id="_2-5-一次性函数"><a href="#_2-5-一次性函数" aria-hidden="true" class="header-anchor">#</a> 2.5 一次性函数</h3> <p>跟上面的惰性载入函数同理，可以在函数体里覆写当前函数，那么可以创建一个一次性的函数，重新赋值之前的代码相当于只运行了一次，适用于运行一些只需要执行一次的初始化代码</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">sca</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'msg'</span><span class="token punctuation">)</span>
    <span class="token function-variable function">sca</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">sca</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment">// msg</span>
<span class="token function">sca</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment">// foo</span>
<span class="token function">sca</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment">// foo</span>
</code></pre></div><h2 id="_3-字符串"><a href="#_3-字符串" aria-hidden="true" class="header-anchor">#</a> 3. 字符串</h2> <h3 id="_3-1-字符串比较时间先后"><a href="#_3-1-字符串比较时间先后" aria-hidden="true" class="header-anchor">#</a> 3.1 字符串比较时间先后</h3> <p>比较时间先后顺序可以使用字符串：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token string">&quot;2014-08-08&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token string">&quot;2014-09-09&quot;</span><span class="token punctuation">;</span>
 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token operator">&gt;</span>b<span class="token punctuation">,</span> a<span class="token operator">&lt;</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;21:00&quot;</span><span class="token operator">&lt;</span><span class="token string">&quot;09:10&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;21:00&quot;</span><span class="token operator">&lt;</span><span class="token string">&quot;9:10&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// true   时间形式注意补0</span>
</code></pre></div><p>因为字符串比较大小是按照字符串从左到右每个字符的charCode来的，但所以特别要注意时间形式注意补0</p> <h2 id="_4-数字"><a href="#_4-数字" aria-hidden="true" class="header-anchor">#</a> 4. 数字</h2> <h3 id="_4-1-不同进制表示法"><a href="#_4-1-不同进制表示法" aria-hidden="true" class="header-anchor">#</a> 4.1 不同进制表示法</h3> <p>ES6中新增了不同进制的书写格式，在后台传参的时候要注意这一点。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">29</span>            <span class="token comment">// 10进制</span>
<span class="token number">035</span>            <span class="token comment">// 8进制29      原来的方式</span>
<span class="token number">0o35</span>            <span class="token comment">// 8进制29      ES6的方式</span>
<span class="token number">0x1d</span>            <span class="token comment">// 16进制29</span>
<span class="token number">0b11101</span>            <span class="token comment">// 2进制29</span>
</code></pre></div><h3 id="_4-2-精确到指定位数的小数"><a href="#_4-2-精确到指定位数的小数" aria-hidden="true" class="header-anchor">#</a> 4.2 精确到指定位数的小数</h3> <p>将数字四舍五入到指定的小数位数。使用 Math.round() 和模板字面量将数字四舍五入为指定的小数位数。 省略第二个参数 decimals ，数字将被四舍五入到一个整数。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">round</span> <span class="token operator">=</span> <span class="token punctuation">(</span>n<span class="token punctuation">,</span> decimals <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">Number</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>`$<span class="token punctuation">{</span>n<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">e</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>decimals<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">}</span>e<span class="token operator">-</span>$<span class="token punctuation">{</span>decimals<span class="token punctuation">}</span>`<span class="token punctuation">)</span>
<span class="token function">round</span><span class="token punctuation">(</span><span class="token number">1.345</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>                 <span class="token comment">// 1.35</span>
<span class="token function">round</span><span class="token punctuation">(</span><span class="token number">1.345</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>                 <span class="token comment">// 1.3</span>
</code></pre></div><h3 id="_4-3-数字补0操作"><a href="#_4-3-数字补0操作" aria-hidden="true" class="header-anchor">#</a> 4.3 数字补0操作</h3> <p>有时候比如显示时间的时候有时候会需要把一位数字显示成两位，这时候就需要补0操作，可以使用slice和string的padStart方法</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">addZero1</span> <span class="token operator">=</span> <span class="token punctuation">(</span>num<span class="token punctuation">,</span> len <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token template-string"><span class="token string">`0</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>num<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token operator">-</span>len<span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">addZero2</span> <span class="token operator">=</span> <span class="token punctuation">(</span>num<span class="token punctuation">,</span> len <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>num<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">padStart</span><span class="token punctuation">(</span> len   <span class="token punctuation">,</span> <span class="token string">'0'</span><span class="token punctuation">)</span>
<span class="token function">addZero1</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">// 03</span>
 
<span class="token function">addZero2</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>  <span class="token comment">// 0032</span>
</code></pre></div><h2 id="_5-数组"><a href="#_5-数组" aria-hidden="true" class="header-anchor">#</a> 5. 数组</h2> <h3 id="_5-1-reduce方法同时实现map和filter"><a href="#_5-1-reduce方法同时实现map和filter" aria-hidden="true" class="header-anchor">#</a> 5.1 reduce方法同时实现map和filter</h3> <p>假设现在有一个数列，你希望更新它的每一项（map的功能）然后筛选出一部分（filter的功能）。如果是先使用map然后filter的话，你需要遍历这个数组两次。
在下面的代码中，我们将数列中的值翻倍，然后挑选出那些大于50的数。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> numbers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> doubledOver50 <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>finalList<span class="token punctuation">,</span> num<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  num <span class="token operator">=</span> num <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">&gt;</span> <span class="token number">50</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    finalList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> finalList<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
doubledOver50<span class="token punctuation">;</span>            <span class="token comment">// [60, 80]</span>
</code></pre></div><h3 id="_5-2-统计数组中相同项的个数"><a href="#_5-2-统计数组中相同项的个数" aria-hidden="true" class="header-anchor">#</a> 5.2 统计数组中相同项的个数</h3> <p>很多时候，你希望统计数组中重复出现项的个数然后用一个对象表示。那么你可以使用reduce方法处理这个数组。</p> <p>下面的代码将统计每一种车的数目然后把总数用一个对象表示。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> cars <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'BMW'</span><span class="token punctuation">,</span><span class="token string">'Benz'</span><span class="token punctuation">,</span> <span class="token string">'Benz'</span><span class="token punctuation">,</span> <span class="token string">'Tesla'</span><span class="token punctuation">,</span> <span class="token string">'BMW'</span><span class="token punctuation">,</span> <span class="token string">'Toyota'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> carsObj <span class="token operator">=</span> cars<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>obj<span class="token punctuation">,</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  obj<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> obj<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">?</span> <span class="token operator">++</span>obj<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> obj<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
carsObj<span class="token punctuation">;</span> <span class="token comment">// =&gt; { BMW: 2, Benz: 2, Tesla: 1, Toyota: 1 }</span>
</code></pre></div><h3 id="_5-3-使用解构来交换参数数值"><a href="#_5-3-使用解构来交换参数数值" aria-hidden="true" class="header-anchor">#</a> 5.3 使用解构来交换参数数值</h3> <p>有时候你会将函数返回的多个值放在一个数组里。我们可以使用数组解构来获取其中每一个值。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> param1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> param2 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>param1<span class="token punctuation">,</span> param2<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>param2<span class="token punctuation">,</span> param1<span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>param1<span class="token punctuation">)</span> <span class="token comment">// 2</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>param2<span class="token punctuation">)</span> <span class="token comment">// 1</span>
</code></pre></div><p>当然我们关于交换数值有不少其他办法：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> temp <span class="token operator">=</span> a<span class="token punctuation">;</span> a <span class="token operator">=</span> b<span class="token punctuation">;</span> b <span class="token operator">=</span> temp            
b <span class="token operator">=</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> a <span class="token operator">=</span> b<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                     
a <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span> b <span class="token operator">=</span> a <span class="token operator">-</span> b<span class="token punctuation">;</span> a <span class="token operator">=</span> a <span class="token operator">-</span> b        
</code></pre></div><h3 id="_5-4-接收函数返回的多个结果"><a href="#_5-4-接收函数返回的多个结果" aria-hidden="true" class="header-anchor">#</a> 5.4 接收函数返回的多个结果</h3> <p>在下面的代码中，我们从/post中获取一个帖子，然后在/comments中获取相关评论。由于我们使用的是async/await，函数把返回值放在一个数组中。而我们使用数组解构后就可以把返回值直接赋给相应的变量。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getFullPost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
     <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'/post'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'/comments'</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>post<span class="token punctuation">,</span> comments<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getFullPost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_5-5-将数组平铺到指定深度"><a href="#_5-5-将数组平铺到指定深度" aria-hidden="true" class="header-anchor">#</a> 5.5 将数组平铺到指定深度</h3> <p>使用递归，为每个深度级别 depth 递减 1 。 使用 Array.reduce() 和 Array.concat() 来合并元素或数组。 基本情况下，depth 等于 1 停止递归。 省略第二个参数，depth 只能平铺到 1 (单层平铺) 的深度。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">flatten</span> <span class="token operator">=</span> <span class="token punctuation">(</span>arr<span class="token punctuation">,</span> depth <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  depth <span class="token operator">!=</span> <span class="token number">1</span>
    <span class="token operator">?</span> arr<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> v<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">flatten</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> depth <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> v<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">:</span> arr<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> v<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">flatten</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                             <span class="token comment">// [1, 2, 3, 4]</span>
<span class="token function">flatten</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// [1, 2, 3, [4, 5], 6, 7, 8]</span>
</code></pre></div><h3 id="_5-6-数组的对象解构"><a href="#_5-6-数组的对象解构" aria-hidden="true" class="header-anchor">#</a> 5.6 数组的对象解构</h3> <p>数组也可以对象解构，可以方便的获取数组的第n个值</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> csvFileLine <span class="token operator">=</span> <span class="token string">'1997,John Doe,US,john@doe.com,New York'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token number">2</span><span class="token punctuation">:</span> country<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">:</span> state <span class="token punctuation">}</span> <span class="token operator">=</span> csvFileLine<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
country            <span class="token comment">// US</span>
state            <span class="token comment">// New Yourk</span>
</code></pre></div><h2 id="_6-对象"><a href="#_6-对象" aria-hidden="true" class="header-anchor">#</a> 6. 对象</h2> <h3 id="_6-1-使用解构删除不必要属性"><a href="#_6-1-使用解构删除不必要属性" aria-hidden="true" class="header-anchor">#</a> 6.1 使用解构删除不必要属性</h3> <p>有时候你不希望保留某些对象属性，也许是因为它们包含敏感信息或仅仅是太大了（just too big）。你可能会枚举整个对象然后删除它们，但实际上只需要简单的将这些无用属性赋值给变量，然后把想要保留的有用部分作为剩余参数就可以了。<br> <br>下面的代码里，我们希望删除_internal和tooBig参数。我们可以把它们赋值给internal和tooBig变量，然后在cleanObject中存储剩下的属性以备后用。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> <span class="token punctuation">{</span>_internal<span class="token punctuation">,</span> tooBig<span class="token punctuation">,</span> <span class="token operator">...</span>cleanObject<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span>el1<span class="token punctuation">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span> _internal<span class="token punctuation">:</span><span class="token string">&quot;secret&quot;</span><span class="token punctuation">,</span> tooBig<span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> el2<span class="token punctuation">:</span> <span class="token string">'2'</span><span class="token punctuation">,</span> el3<span class="token punctuation">:</span> <span class="token string">'3'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cleanObject<span class="token punctuation">)</span><span class="token punctuation">;</span>                         <span class="token comment">// {el1: '1', el2: '2', el3: '3'}</span>
</code></pre></div><h3 id="_6-2-在函数参数中解构嵌套对象"><a href="#_6-2-在函数参数中解构嵌套对象" aria-hidden="true" class="header-anchor">#</a> 6.2 在函数参数中解构嵌套对象</h3> <p>在下面的代码中，engine是对象car中嵌套的一个对象。如果我们对engine的vin属性感兴趣，使用解构赋值可以很轻松地得到它。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> car <span class="token operator">=</span> <span class="token punctuation">{</span>
  model<span class="token punctuation">:</span> <span class="token string">'bmw 2018'</span><span class="token punctuation">,</span>
  engine<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    v6<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    turbo<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    vin<span class="token punctuation">:</span> <span class="token number">12345</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">modelAndVIN</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>model<span class="token punctuation">,</span> engine<span class="token punctuation">:</span> <span class="token punctuation">{</span>vin<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`model: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>model<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> vin: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>vin<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">modelAndVIN</span><span class="token punctuation">(</span>car<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; model: bmw 2018  vin: 12345</span>
</code></pre></div><h2 id="_7-代码复用"><a href="#_7-代码复用" aria-hidden="true" class="header-anchor">#</a> 7. 代码复用</h2> <h3 id="_7-1-object-key"><a href="#_7-1-object-key" aria-hidden="true" class="header-anchor">#</a> 7.1 Object [key]</h3> <p>虽然将 foo.bar 写成 foo ['bar'] 是一种常见的做法，但是这种做法构成了编写可重用代码的基础。许多框架使用了这种方法，比如element的表单验证。</p> <p>请考虑下面这个验证函数的简化示例：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">validate</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>values<span class="token punctuation">.</span>first<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>values<span class="token punctuation">.</span>last<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>first<span class="token punctuation">:</span><span class="token string">'Bruce'</span><span class="token punctuation">,</span>last<span class="token punctuation">:</span><span class="token string">'Wayne'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p>上面的函数完美的完成验证工作。但是当有很多表单，则需要应用验证，此时会有不同的字段和规则。如果可以构建一个在运行时配置的通用验证函数，会是一个好选择。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// object validation rules</span>
<span class="token keyword">const</span> schema <span class="token operator">=</span> <span class="token punctuation">{</span>
  first<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    required<span class="token punctuation">:</span><span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  last<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    required<span class="token punctuation">:</span><span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
 
<span class="token comment">// universal validation function</span>
<span class="token keyword">const</span> <span class="token function-variable function">validate</span> <span class="token operator">=</span> <span class="token punctuation">(</span>schema<span class="token punctuation">,</span> values<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>field <span class="token keyword">in</span> schema<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>schema<span class="token punctuation">[</span>field<span class="token punctuation">]</span><span class="token punctuation">.</span>required<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>values<span class="token punctuation">[</span>field<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">validate</span><span class="token punctuation">(</span>schema<span class="token punctuation">,</span> <span class="token punctuation">{</span>first<span class="token punctuation">:</span><span class="token string">'Bruce'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">validate</span><span class="token punctuation">(</span>schema<span class="token punctuation">,</span> <span class="token punctuation">{</span>first<span class="token punctuation">:</span><span class="token string">'Bruce'</span><span class="token punctuation">,</span>last<span class="token punctuation">:</span><span class="token string">'Wayne'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p>现在有了这个验证函数，我们就可以在所有窗体中重用，而无需为每个窗体编写自定义验证函数。</p></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/5.b3747f02.js" defer></script><script src="/assets/js/app.a8f93003.js" defer></script>
  </body>
</html>
